'use strict';

const http = require('http');
const https = require('https');

var agentMap = {};

class RequestAgent {
	constructor(protocol, host, replaceAgent) {
		const isHttps = protocol === 'https:';
		if (agentMap[protocol] === undefined) {
			agentMap[protocol] = {};
		}
		let protocolMap = agentMap[protocol];
		if (protocolMap[host] === undefined || replaceAgent || false) {
			protocolMap[host] = isHttps
				? new https.Agent({ keepAlive: true })
				: new http.Agent({ keepAlive: true });
		}
		this.agent = protocolMap[host];
	}
}
exports.RequestAgent = RequestAgent;
